<scroll-view
	class="ui-page wall-manage-page"
	scroll-y="true"
	enable-back-to-top="true"
	refresher-enabled="{{true}}"
	refresher-triggered="{{refreshing}}"
	bindrefresherrefresh="onRefresh"
	bindscrolltolower="loadMore">
	<view class="ui-card ui-card--quiet admin-tab-bar">
		<text
			wx:for="{{tabList}}"
			wx:key="key"
			class="admin-tab {{activeTab === item.key ? 'is-active' : ''}}"
			bindtap="switchTab"
			data-key="{{item.key}}">
			{{item.label}}
		</text>
	</view>

	<view class="ui-card wall-manage-hero">
		<text class="ui-title">{{tabTitles[activeTab]}}</text>
	</view>

	<block wx:if="{{activeTab === 'wall'}}">
		<view class="ui-card ui-card--quiet wall-manage-stats">
			<view class="wall-manage-stats__item is-warning">
				<text class="wall-manage-stats__value">{{wall.statistics.pending_count || 0}}</text>
				<text class="wall-manage-stats__label">å¾…å®¡æ ¸</text>
			</view>
			<view class="wall-manage-stats__item is-success">
				<text class="wall-manage-stats__value">{{wall.statistics.approved_count || 0}}</text>
				<text class="wall-manage-stats__label">å·²é€šè¿‡</text>
			</view>
			<view class="wall-manage-stats__item is-info">
				<text class="wall-manage-stats__value">{{wall.statistics.total_count || 0}}</text>
				<text class="wall-manage-stats__label">æ€»æ¶ˆæ¯</text>
			</view>
		</view>

		<view class="ui-card ui-card--quiet wall-manage-filters">
			<view class="wall-manage-tabs">
				<text class="wall-manage-tab {{wall.currentStatus === 'PENDING' ? 'is-active' : ''}}" bindtap="switchWallStatus" data-status="PENDING">å¾…å®¡æ ¸</text>
				<text class="wall-manage-tab {{wall.currentStatus === 'APPROVED' ? 'is-active' : ''}}" bindtap="switchWallStatus" data-status="APPROVED">å·²é€šè¿‡</text>
				<text class="wall-manage-tab {{wall.currentStatus === 'REJECTED' ? 'is-active' : ''}}" bindtap="switchWallStatus" data-status="REJECTED">å·²æ‹’ç»</text>
				<text class="wall-manage-tab {{wall.currentStatus === 'ALL' ? 'is-active' : ''}}" bindtap="switchWallStatus" data-status="ALL">å…¨éƒ¨</text>
			</view>
		</view>

		<view class="wall-manage-list">
			<view wx:for="{{wall.messages}}" wx:key="id" class="wall-manage-card ui-card ui-card--quiet">
				<view class="wall-manage-card__head">
					<text class="wall-manage-card__type type-{{item.message_type}}">{{item.vmessage_type}}</text>
					<text class="wall-manage-card__status status-{{item.statusClass}}">{{item.vstatus}}</text>
					<text class="wall-manage-card__time">{{item.vtimestamp}}</text>
				</view>
				<view class="wall-manage-card__body">
					<text class="wall-manage-card__title" wx:if="{{item.title}}">{{item.title}}</text>
					<text class="wall-manage-card__content">{{item.content}}</text>
					<view wx:if="{{item.hasimage}}" class="wall-manage-card__media">
						<t-grid column="{{4}}">
							<t-grid-item wx:for="{{item.images}}" wx:key="*this" wx:for-item="image">
								<t-image src="{{image}}" width="120" height="120"></t-image>
							</t-grid-item>
						</t-grid>
					</view>
				</view>
				<view class="wall-manage-card__meta">
					<text class="wall-manage-card__author">ç”¨æˆ·IDï¼š{{item.user_id}}</text>
					<text class="wall-manage-card__stats">ğŸ‘ {{item.view_count || 0}} | ğŸ‘ {{item.like_count || 0}}</text>
				</view>
				<view class="wall-manage-card__actions" wx:if="{{item.status === 'PENDING'}}">
					<button class="wall-manage-btn wall-manage-btn--primary" bindtap="approveWallMessage" data-id="{{item.id}}">é€šè¿‡</button>
					<button class="wall-manage-btn wall-manage-btn--warn" bindtap="rejectWallMessage" data-id="{{item.id}}">æ‹’ç»</button>
				</view>
				<view class="wall-manage-card__actions" wx:if="{{item.status === 'APPROVED'}}">
					<button class="wall-manage-btn wall-manage-btn--warn" bindtap="rejectWallMessage" data-id="{{item.id}}">æ’¤å›</button>
					<button class="wall-manage-btn wall-manage-btn--danger" bindtap="deleteWallMessage" data-id="{{item.id}}">åˆ é™¤</button>
				</view>
				<view class="wall-manage-card__actions" wx:if="{{item.status === 'REJECTED'}}">
					<button class="wall-manage-btn wall-manage-btn--primary" bindtap="approveWallMessage" data-id="{{item.id}}">æ¢å¤</button>
					<button class="wall-manage-btn wall-manage-btn--danger" bindtap="deleteWallMessage" data-id="{{item.id}}">åˆ é™¤</button>
				</view>
			</view>
		</view>

		<view class="wall-manage-state" wx:if="{{wall.loading}}">åŠ è½½ä¸­...</view>
		<view class="wall-manage-state" wx:if="{{!wall.loading && wall.messages.length === 0}}">æš‚æ— æ¶ˆæ¯</view>
		<view class="wall-manage-state wall-manage-state--end" wx:if="{{!wall.loading && !wall.hasMore && wall.messages.length > 0}}">å·²æ˜¾ç¤ºå…¨éƒ¨å†…å®¹</view>
	</block>

	<block wx:elif="{{activeTab === 'comment'}}">
		<view class="ui-card ui-card--quiet wall-manage-filters">
			<view class="wall-manage-tabs">
				<text class="wall-manage-tab {{comment.currentStatus === 'PENDING' ? 'is-active' : ''}}" data-status="PENDING" bindtap="switchCommentStatus">å¾…å®¡æ ¸</text>
				<text class="wall-manage-tab {{comment.currentStatus === 'APPROVED' ? 'is-active' : ''}}" data-status="APPROVED" bindtap="switchCommentStatus">å·²é€šè¿‡</text>
				<text class="wall-manage-tab {{comment.currentStatus === 'REJECTED' ? 'is-active' : ''}}" data-status="REJECTED" bindtap="switchCommentStatus">å·²æ‹’ç»</text>
			</view>
		</view>

		<view class="wall-manage-list">
			<view wx:for="{{comment.items}}" wx:key="id" class="wall-manage-card ui-card ui-card--quiet">
				<view class="wall-manage-card__head">
					<text class="wall-manage-card__status status-{{item.statusClass}}">{{item.vstatus}}</text>
					<text class="wall-manage-card__time">{{item.vtimestamp}}</text>
				</view>
				<view class="wall-manage-card__body">
					<text class="wall-manage-card__content">{{item.content}}</text>
				</view>
				<view class="wall-manage-card__meta">
					<text class="wall-manage-card__author">ç”¨æˆ·IDï¼š{{item.user_id}}</text>
					<text class="wall-manage-card__stats">ğŸ‘ {{item.like_count || 0}}</text>
				</view>
				<view class="wall-manage-card__actions" wx:if="{{item.status === 'PENDING'}}">
					<button class="wall-manage-btn wall-manage-btn--primary" bindtap="approveComment" data-id="{{item.id}}">é€šè¿‡</button>
					<button class="wall-manage-btn wall-manage-btn--warn" bindtap="rejectComment" data-id="{{item.id}}">æ‹’ç»</button>
					<button class="wall-manage-btn wall-manage-btn--danger" bindtap="deleteComment" data-id="{{item.id}}">åˆ é™¤</button>
				</view>
				<view class="wall-manage-card__actions" wx:if="{{item.status === 'APPROVED'}}">
					<button class="wall-manage-btn wall-manage-btn--warn" bindtap="rejectComment" data-id="{{item.id}}">æ’¤å›</button>
					<button class="wall-manage-btn wall-manage-btn--danger" bindtap="deleteComment" data-id="{{item.id}}">åˆ é™¤</button>
				</view>
				<view class="wall-manage-card__actions" wx:if="{{item.status === 'REJECTED'}}">
					<button class="wall-manage-btn wall-manage-btn--primary" bindtap="approveComment" data-id="{{item.id}}">æ¢å¤</button>
					<button class="wall-manage-btn wall-manage-btn--danger" bindtap="deleteComment" data-id="{{item.id}}">åˆ é™¤</button>
				</view>
			</view>
		</view>

		<view class="wall-manage-state" wx:if="{{comment.loading}}">åŠ è½½ä¸­...</view>
		<view class="wall-manage-state" wx:if="{{!comment.loading && comment.items.length === 0}}">æš‚æ— è¯„è®º</view>
	</block>

	<block wx:elif="{{activeTab === 'song'}}">
		<view class="ui-card ui-card--quiet wall-manage-stats">
			<view class="wall-manage-stats__item is-warning">
				<text class="wall-manage-stats__value">{{song.statistics.pending_count || 0}}</text>
				<text class="wall-manage-stats__label">å¾…å®¡æ ¸</text>
			</view>
			<view class="wall-manage-stats__item is-success">
				<text class="wall-manage-stats__value">{{song.statistics.approved_count || 0}}</text>
				<text class="wall-manage-stats__label">å·²é€šè¿‡</text>
			</view>
			<view class="wall-manage-stats__item is-info">
				<text class="wall-manage-stats__value">{{song.statistics.total_requests || 0}}</text>
				<text class="wall-manage-stats__label">æ€»è¯·æ±‚</text>
			</view>
		</view>

		<view class="ui-card ui-card--quiet wall-manage-filters">
			<view class="wall-manage-tabs">
				<text class="wall-manage-tab {{song.currentStatus === 'pending' ? 'is-active' : ''}}" data-status="pending" bindtap="switchSongStatus">å¾…å®¡æ ¸</text>
				<text class="wall-manage-tab {{song.currentStatus === 'approved' ? 'is-active' : ''}}" data-status="approved" bindtap="switchSongStatus">å·²é€šè¿‡</text>
				<text class="wall-manage-tab {{song.currentStatus === 'rejected' ? 'is-active' : ''}}" data-status="rejected" bindtap="switchSongStatus">å·²æ‹’ç»</text>
				<text class="wall-manage-tab {{song.currentStatus === 'all' ? 'is-active' : ''}}" data-status="all" bindtap="switchSongStatus">å…¨éƒ¨</text>
			</view>
		</view>

		<view class="wall-manage-list">
			<view wx:for="{{song.items}}" wx:key="id" class="wall-manage-card ui-card ui-card--quiet">
				<view class="wall-manage-card__head">
					<text class="wall-manage-card__status status-{{item.statusClass}}">{{item.vstatus}}</text>
					<text class="wall-manage-card__time">{{item.vtime}}</text>
				</view>
				<view class="wall-manage-card__body">
					<text class="wall-manage-card__title">{{item.displayTitle || item.song_name}}</text>
					<text class="wall-manage-card__content" wx:if="{{item.displayArtist}}">æ¼”å”±ï¼š{{item.displayArtist}}</text>
					<text class="wall-manage-card__content">è¯·æ±‚äººï¼š{{item.requester}}</text>
				</view>
				<view class="wall-manage-card__meta">
					<text class="wall-manage-card__author">æ­Œæ›²IDï¼š{{item.song_id}}</text>
				</view>
				<view class="wall-manage-card__actions" wx:if="{{item.status === 'pending'}}">
					<button class="wall-manage-btn wall-manage-btn--primary" bindtap="approveSong" data-id="{{item.id}}">é€šè¿‡</button>
					<button class="wall-manage-btn wall-manage-btn--warn" bindtap="rejectSong" data-id="{{item.id}}">æ‹’ç»</button>
				</view>
			</view>
		</view>

		<view class="wall-manage-state" wx:if="{{song.loading}}">åŠ è½½ä¸­...</view>
		<view class="wall-manage-state" wx:if="{{!song.loading && song.items.length === 0}}">æš‚æ— ç‚¹æ­Œè¯·æ±‚</view>
		<view class="wall-manage-state wall-manage-state--end" wx:if="{{!song.loading && !song.hasMore && song.items.length > 0}}">å·²æ˜¾ç¤ºå…¨éƒ¨å†…å®¹</view>
	</block>
</scroll-view>